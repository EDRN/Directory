<?xml version='1.0' encoding='UTF-8'?>
<!--
EDRN Directory Service â€” Apache DS configuration for development.  Note that
this file, ``apacheds-dev.xml`` generates ``server.xml``.  Are you editing the
right file?

Copyright 2012 California Institute of Technology. ALL RIGHTS
RESERVED. U.S. Government Sponsorship acknowledged.
-->
<spring:beans
    xmlns='http://apacheds.org/config/1.5.7'
    xmlns:spring='http://xbean.apache.org/schemas/spring/1.0'
    xmlns:s='http://www.springframework.org/schema/beans'>
    <defaultDirectoryService
        id='directoryService'
        instanceId='default'
        replicaId='1'
        workingDirectory='${buildout:directory}/var/edrn.jpl.nasa.gov'
        allowAnonymousAccess='false'
        accessControlEnabled='false'
        denormalizeOpAttrsEnabled='false'
        syncPeriodMillis='15000'
        maxPDUSize='2000000'>
        <systemPartition>
            <jdbmPartition id='system' cacheSize='100' suffix='ou=system' optimizerEnabled='true' syncOnWrite='true'>
                <indexedAttributes>
                    <jdbmIndex attributeId='1.3.6.1.4.1.18060.0.4.1.2.1' cacheSize='100'/>
                    <jdbmIndex attributeId='1.3.6.1.4.1.18060.0.4.1.2.2' cacheSize='100'/>
                    <jdbmIndex attributeId='1.3.6.1.4.1.18060.0.4.1.2.3' cacheSize='100'/>
                    <jdbmIndex attributeId='1.3.6.1.4.1.18060.0.4.1.2.4' cacheSize='100'/>
                    <jdbmIndex attributeId='1.3.6.1.4.1.18060.0.4.1.2.5' cacheSize='10'/>
                    <jdbmIndex attributeId='1.3.6.1.4.1.18060.0.4.1.2.6' cacheSize='10'/>
                    <jdbmIndex attributeId='1.3.6.1.4.1.18060.0.4.1.2.7' cacheSize='10'/>
                    <jdbmIndex attributeId='ou' cacheSize='100'/>
                    <jdbmIndex attributeId='uid' cacheSize='100'/>
                    <jdbmIndex attributeId='objectClass' cacheSize='100'/>
                </indexedAttributes>
            </jdbmPartition>
        </systemPartition>
        <partitions>
            <jdbmPartition id='edrn' cacheSize='200' suffix='dc=edrn,dc=jpl,dc=nasa,dc=gov'
                optimizerEnabled='true' syncOnWrite='true'>
                <indexedAttributes>
                    <jdbmIndex attributeId='1.3.6.1.4.1.18060.0.4.1.2.1' cacheSize='100'/>
                    <jdbmIndex attributeId='1.3.6.1.4.1.18060.0.4.1.2.2' cacheSize='100'/>
                    <jdbmIndex attributeId='1.3.6.1.4.1.18060.0.4.1.2.3' cacheSize='100'/>
                    <jdbmIndex attributeId='1.3.6.1.4.1.18060.0.4.1.2.4' cacheSize='100'/>
                    <jdbmIndex attributeId='1.3.6.1.4.1.18060.0.4.1.2.5' cacheSize='10'/>
                    <jdbmIndex attributeId='1.3.6.1.4.1.18060.0.4.1.2.6' cacheSize='10'/>
                    <jdbmIndex attributeId='1.3.6.1.4.1.18060.0.4.1.2.7' cacheSize='10'/>
                    <jdbmIndex attributeId='dc' cacheSize='100'/>
                    <jdbmIndex attributeId='ou' cacheSize='100'/>
                    <jdbmIndex attributeId='uid' cacheSize='100'/>
                    <jdbmIndex attributeId='objectClass' cacheSize='100'/>
                </indexedAttributes>
            </jdbmPartition>
        </partitions>
        <interceptors>
            <normalizationInterceptor/>
            <s:bean class='gov.nasa.jpl.edrn.dmcc.auth.DMCCAuthenticationInterceptor'/>
            <authenticationInterceptor/>
            <referralInterceptor/>
            <aciAuthorizationInterceptor/>
            <defaultAuthorizationInterceptor/>
            <exceptionInterceptor/>
            <operationalAttributeInterceptor/>
            <schemaInterceptor/>
            <subentryInterceptor/>
            <collectiveAttributeInterceptor/>
            <eventInterceptor/>
            <triggerInterceptor/>
        </interceptors>
    </defaultDirectoryService>
    <ldapServer
        id='ldapServer'
        allowAnonymousAccess='true'
        saslHost='edrn.jpl.nasa.gov'
        saslPrincipal='ldap/edrn.jpl.nasa.gov@edrn.jpl.nasa.gov'
        searchBaseDn='dc=edrn,dc=jpl,dc=nasa,dc=gov'
        maxTimeLimit='25000'
        maxSizeLimit='2000'
        keystoreFile='${buildout:directory}/etc/certs/cancer.ks'
        certificatePassword='${passwords:ldap-keystore-password}'>
        <transports>
            <tcpTransport address='${interfaces:ldap}' port='${ports:ldap}' nbThreads='5' backLog='50' enableSSL='false'/>
            <tcpTransport address='${interfaces:ldaps}' port='${ports:ldaps}' enableSSL='true'/>
        </transports>
        <directoryService>#directoryService</directoryService>
        <saslMechanismHandlers>
            <simpleMechanismHandler mech-name='SIMPLE'/>
            <cramMd5MechanismHandler mech-name='CRAM-MD5'/>
            <digestMd5MechanismHandler mech-name='DIGEST-MD5'/>
            <gssapiMechanismHandler mech-name='GSSAPI'/>
        </saslMechanismHandlers>
        <saslRealms>
            <s:value>edrn.jpl.nasa.gov</s:value>
            <s:value>cancer.jpl.nasa.gov</s:value>
            <s:value>edrn.nci.nih.gov</s:value>
        </saslRealms>
        <extendedOperationHandlers>
            <startTlsHandler/>
            <gracefulShutdownHandler/>
            <launchDiagnosticUiHandler/>
        </extendedOperationHandlers>
    </ldapServer>
    <apacheDS id='apacheDS'>
        <ldapServer>#ldapServer</ldapServer>
    </apacheDS>
</spring:beans>
